
<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>DIC cafe</title>
    <meta charset="utf-8">
    <link href="css/nomalize.css" rel="stylesheet">
    <link href="css/common.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <header class="header_nav">
      <nav class="header_nav">
        <a href="index.html" class="logo"><img src="images/sample_logo_k.png"></a>
        <ul class="global_nav">
          <a href="index.html" class="global_nav_item">
            <li>Home</li>
          </a>
          <a href="blueberry_pancakes.html" class="global_nav_item">
            <li>Menu</li>
          </a>
          <a href="contact.html" class="global_nav_item">
            <li>Contact</li>
          </a>
        </ul>
      </nav>
    </header>
    <div class="menu_key section_inner">
    </div>
    <section class="section_inner">
      <div class="section_title">
        <h1>Coffee Bean Sale</h1>
      </div>
    </section>

    <section class="section_inner menu_section">
      <div class="center">
        <h1 class="menu_title">Lineup</h1>
      </div>
      <ul class="menu_list coffee_menu">
        <li class="caffee_menu_list_item">
          <div class="caffee_menu_content">
            <h2 class="menu_item_title">Original blend 200g</h2>
            <p class="caffee_menu_price">500 yen</p>
          </div>
          <img src="images/sample_cafe1.jpg" class="caffee_menu_image">
        </li>
        <li class="caffee_menu_list_item">
          <div class="caffee_menu_content">
            <h2 class="menu_item_title">original blend 500g</h2>
            <p class="caffee_menu_price">900 yen</p>
          </div>
          <img src="images/sample_cafe1.jpg" class="caffee_menu_image">
        </li>
        <li class="caffee_menu_list_item">
          <div class="caffee_menu_content">
            <h2 class="menu_item_title">Special blend 200g</h2>
            <p class="caffee_menu_price">700 yen</p>
          </div>
          <img src="images/sample_cafe3.jpg" class="caffee_menu_image">
        </li>
        <li class="caffee_menu_list_item">
          <div class="caffee_menu_content">
            <h2 class="menu_item_title">Special blend 500g</h2>
            <p class="caffee_menu_price">1200 yen</p>
          </div>
          <img src="images/sample_cafe3.jpg" class="caffee_menu_image">
        </li>
      </ul>
      <h2>Guidance of the postage</h2>
      <ul>
        <li>・If the total amount is less than 2000 yen, the shipping fee is 500 yen. </li>
        <li>・250 yen for purchases over 2000 yen </li>
        <li>・Free for purchases over 3,000 yen</li>
      </ul>
    </section>

    <section class="section_inner">
      <h2>Order</h2>
      <form>
        <p>Seleccione un producto</p>
        <div>
          <select id="product" required>
            <option hidden value="0">Por favor, seleccione.</option>
            <option value="1">Mezcla original 200g ¥ 500</option>
            <option value="2">Mezcla original 500g ¥ 900</option>
            <option value="3">Mezcla especial 200g ¥ 700</option>
            <option value="4">Mezcla especial 500g, 1.200 yenes.</option>
          </select>
          <p>Seleccione la cantidad</p>
          <input type="number" min="1" max="5" id="number" required>
        </div>
        <br>
        <input type="button" class="btn" value="Total Amount" onclick="add()">
        <input type="button" class="btn" value="To add" onclick="calc()">
      </form>
    </section>
    <footer class="footer">
      <nav>
        <ul class="footer_nav">
          <a href="index.html" class="footer_nav_item">
            <li>Home</li>
          </a>
          <a href="blueberry_pancakes.html" class="footer_nav_item">
            <li>Menu</li>
          </a>
          <a href="contact.html" class="footer_nav_item">
            <li>Contact</li>
          </a>
          <a href="contact.html" class="footer_nav_item">
            <li>
              <img src="images/sample_logo_w.png" class="footer_logo">
            </li>
          </a>
        </ul>
      </nav>
      <p class="footer_right">© DIVE INTO CODE Corp. All RIGHTS RESERVED.</p>
    </footer>
    <style>
      .btn {
        display: inline-block;
        padding: .8rem 2rem;
        z-index: 10;
        text-align: center;
        border-radius: 5px;
        background: rgba(127,136,182,1);
        color: white;
      }
    </style>
    <script>
      const products = [
        {
          id: 1,
          name: "Original Blend 200g",
          price: 500,
        },
        {
          id: 2,
          name: "Original Blend 500g",
          price: 900,
        },
        {
          id: 3,
          name: "Special Blend 200g",
          price: 700,
        },
        {
          id: 4,
          name: "Original Blend 200g",
          price: 1200,
        }
      ]
      const priceElement = document.getElementById("product");
      const numberElement = document.getElementById("number");
      let purchases = [];
      function add() {
        const targetId  = parseInt(priceElement.value);
        const product = products.find(item => item.id == targetId);
        const number = numberElement.value;

        let purchase = {
          product: product,
          number: parseInt(number),
        };

        const newPurchase = purchases.findIndex((item) => item.product.id === purchase.product.id)
        if(purchases.length < 1 || newPurchase === -1) {
          purchases.push(purchase)
        } else {
          purchases[newPurchase].number += purchase.number
        }

        window.alert(`${display()}\nSubtotal${subtotal()} Yen`);
        priceElement.value = "";
        numberElement.value = "";
      }

      function subtotal() {
        return purchases.reduce((prev, purchase) => {
          return prev + purchase.product.price * purchase.number;
        }, 0)
      }

      function display() {
        return purchases.map(purchase => {
          return `${purchase.product.name} ${purchase.product.price}円:${purchase.number}点\n`;
        }).join("")
      };

      function calcPostageFromPurchase(sum) {
        if (sum == 0 || sum >= 3000) {
          return 0
        } else if (sum < 1000){
          return 500
        } else {
          return 250
        }
      }

      function calc() {
        const sum = subtotal();
        const postage = calcPostageFromPurchase(sum);
        window.alert(`${display()}\n小計は${sum}円、送料は${postage}円です。合計は${sum + postage}円です`);
        purchases = [];
        priceElement.value= "";
        numberElement.value = "";
      }
    </script>
  </body>
</html>